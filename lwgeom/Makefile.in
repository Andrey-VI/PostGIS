#
# PostGIS PGXS build system
#
MODULE_big=lwpostgis


# Files to be copied to the contrib/ directory
DATA_built=lwpostgis.sql
DATA=../spatial_ref_sys.sql

# SQL objects (files requiring C pre-processing)
SQL_OBJS=lwpostgis.sql.in

# Standalone LWGEOM objects
SA_OBJS=measures.o \
	box2d.o \
	ptarray.o \
	lwgeom_api.o \
	lwgeom.o \
	lwpoint.o \
	lwline.o \
	lwpoly.o \
	lwmpoint.o \
	lwmline.o \
	lwmpoly.o \
	lwcollection.o \
	lwgeom_geos_c.o \
	wktunparse.o \
	lwgparse.o \
	wktparse.tab.o \
	lex.yy.o \
	vsprintf.o	

# PostgreSQL objects
PG_OBJS=liblwgeom.o \
	lwgeom_pg.o \
	lwgeom_debug.o \
	lwgeom_spheroid.o \
	lwgeom_ogc.o \
	lwgeom_functions_analytic.o \
	$(JTS_OBJ) \
	lwgeom_inout.o \
	lwgeom_estimate.o \
	lwgeom_functions_basic.o \
	lwgeom_gist.o \
	lwgeom_btree.o \
	lwgeom_transform.o \
	stringBuffer.o \
	lwgeom_box.o \
	lwgeom_box3d.o \
	lwgeom_box2dfloat4.o \
	lwgeom_chip.o \
	lwgeom_svg.o \
	lwgeom_gml.o \
	lwgeom_kml.o \
	lwgeom_geojson.o \
	lwgeom_triggers.o \
	lwgeom_dump.o \
	lwgeom_functions_lrs.o \
	long_xact.o \
	lwcurve.o \
	lwcompound.o \
	lwcurvepoly.o \
	lwmcurve.o \
	lwmsurface.o \
	lwgeom_sqlmm.o \
	lwgeom_rtree.o

# Objects to build using PGXS
OBJS=$(SA_OBJS) $(PG_OBJS)

# Libraries to link into the module (proj, geos)
SHLIB_LINK=@SHLIB_LINK@

# Extra files to remove during 'make clean'
EXTRA_CLEAN=$(SQL_OBJS)

# PGXS information
PG_CONFIG = pg_config
PGXS := $(shell $(PG_CONFIG) --pgxs)
include $(PGXS)


# Generate any .sql.in files from .sql.in.c files by running them through the C pre-processor 
$(SQL_OBJS): %.in: %.in.c
	$(CPP) -traditional-cpp $< | grep -v '^#' > $@

